<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gitlab流水线配置 | hengshuai's blog</title>
    <meta name="description" content="带你理解gitlab流水线的概念，熟练掌握流水线的常用技巧">
    <meta name="generator" content="VitePress v1.0.0-rc.40">
    <link rel="preload stylesheet" href="/assets/style.NwX665RZ.css" as="style">
    
    <script type="module" src="/assets/app.0fd12bH9.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.bvIUbFQP.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.SV1ROkXV.js">
    <link rel="modulepreload" href="/assets/chunks/theme.l3RjJB8k.js">
    <link rel="modulepreload" href="/assets/fullstack_gitlab_gitlab-pipeline.md.2PnzZMhY.lean.js">
    <meta name="renderer" content="webkit">
    <meta name="author" content="ihengshuai@foxmail.com">
    <meta rel="profile" href="http://gmpg.org/xfn/11">
    <meta name="referrer" content="same-origin">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="theme-color" content="#646cff">
    <meta name="google-site-verification" content="T4xYOJVbUxeU5aZRUROdmEf_NWCjnRDwfXnzKYUVcFM">
    <meta name="baidu-site-verification" content="code-IpD4H7zKv4">
    <link rel="apple-touch-icon" href="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/192.png">
    <meta name="apple-mobile-web-app-title" content="hengshuai&#39;s blog">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#747bff">
    <meta rel="apple-touch-startup-image" href="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/192.png">
    <link rel="manifest" href="/manifest.json">
    <script id="ENV_VARIABLES">window.__ENV_VARIABLES__={ENV_PROD:!0};</script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V5736Z4DWT"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-V5736Z4DWT");</script>
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f6eda4089bba0c6f46ad6e00658a80f3";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"dark",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta name="keywords" content="gitlab流水线,流水线,CI/CD,自动化构建">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Gitlab流水线配置 | hengshuai&#39;s blog">
    <meta property="og:url" content="https://blog.usword.cn/fullstack/gitlab/gitlab-pipeline.html">
    <meta property="og:site_name" content="hengshuai&#39;s blog">
    <meta property="og:description" content="带你理解gitlab流水线的概念，熟练掌握流水线的常用技巧">
    <meta property="og:image" content="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/icon-gitlab.png">
    <meta name="twitter:url" value="https://blog.usword.cn/fullstack/gitlab/gitlab-pipeline.html">
    <meta name="twitter:title" value="Gitlab流水线配置 | hengshuai&#39;s blog">
    <meta name="twitter:domain" value="https://blog.usword.cn">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" value="带你理解gitlab流水线的概念，熟练掌握流水线的常用技巧">
    <meta name="twitter:image" content="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/icon-gitlab.png">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-e69ff593><!--[--><!--]--><!--[--><span tabindex="-1" data-v-056fc64b></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-056fc64b> Skip to content </a><!--]--><!----><header class="VPNav" data-v-e69ff593 data-v-50ee880a><div class="VPNavBar has-sidebar" data-v-50ee880a data-v-575c0058><div class="wrapper" data-v-575c0058><div class="container" data-v-575c0058><div class="title" data-v-575c0058><div class="VPNavBarTitle has-sidebar" data-v-575c0058 data-v-5a8562d3><a class="title" href="/" data-v-5a8562d3><!--[--><!--]--><!----><!--[-->Hengshuai&#39;s blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-575c0058><div class="content-body" data-v-575c0058><!--[--><!--]--><div class="VPNavBarSearch search" data-v-575c0058><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-575c0058 data-v-3e017cdf><span id="main-nav-aria-label" class="visually-hidden" data-v-3e017cdf>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/frontend/base.html" tabindex="0" data-v-3e017cdf data-v-2b0d6775><!--[--><span data-v-2b0d6775>Frontend</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fullstack/base.html" tabindex="0" data-v-3e017cdf data-v-2b0d6775><!--[--><span data-v-2b0d6775>Fullstack</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/article/base.html" tabindex="0" data-v-3e017cdf data-v-2b0d6775><!--[--><span data-v-2b0d6775>Article</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://case.usword.cn" target="_blank" rel="noreferrer" tabindex="0" data-v-3e017cdf data-v-2b0d6775><!--[--><span data-v-2b0d6775>Case</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/me.html" tabindex="0" data-v-3e017cdf data-v-2b0d6775><!--[--><span data-v-2b0d6775>Me</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-575c0058 data-v-3bd0ddce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-3bd0ddce data-v-62e667eb data-v-0438efbe><span class="check" data-v-0438efbe><span class="icon" data-v-0438efbe><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-62e667eb><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-62e667eb><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-575c0058 data-v-47b9b291 data-v-f534a663><!--[--><a class="VPSocialLink no-icon" href="https://github.com/ihengshuai" aria-label="github" target="_blank" rel="noopener" data-v-f534a663 data-v-70b9b240><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-575c0058 data-v-edb1db61 data-v-41b0fac7><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-41b0fac7><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-41b0fac7><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-41b0fac7><div class="VPMenu" data-v-41b0fac7 data-v-32c6b1d0><!----><!--[--><!--[--><!----><div class="group" data-v-edb1db61><div class="item appearance" data-v-edb1db61><p class="label" data-v-edb1db61>Appearance</p><div class="appearance-action" data-v-edb1db61><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-edb1db61 data-v-62e667eb data-v-0438efbe><span class="check" data-v-0438efbe><span class="icon" data-v-0438efbe><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-62e667eb><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-62e667eb><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-edb1db61><div class="item social-links" data-v-edb1db61><div class="VPSocialLinks social-links-list" data-v-edb1db61 data-v-f534a663><!--[--><a class="VPSocialLink no-icon" href="https://github.com/ihengshuai" aria-label="github" target="_blank" rel="noopener" data-v-f534a663 data-v-70b9b240><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-575c0058 data-v-279e6295><span class="container" data-v-279e6295><span class="top" data-v-279e6295></span><span class="middle" data-v-279e6295></span><span class="bottom" data-v-279e6295></span></span></button></div></div></div></div><div class="divider" data-v-575c0058><div class="divider-line" data-v-575c0058></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-e69ff593 data-v-2ebb1e0d><div class="container" data-v-2ebb1e0d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2ebb1e0d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2ebb1e0d><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2ebb1e0d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2ebb1e0d data-v-ba90ba94><button data-v-ba90ba94>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-e69ff593 data-v-983e8791><div class="curtain" data-v-983e8791></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-983e8791><span class="visually-hidden" id="sidebar-aria-label" data-v-983e8791> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-983e8791><section class="VPSidebarItem level-0" data-v-983e8791 data-v-3445ab86><div class="item" role="button" tabindex="0" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><h2 class="text" data-v-3445ab86>Docker</h2><!----></div><div class="items" data-v-3445ab86><!--[--><section class="VPSidebarItem level-1" data-v-3445ab86 data-v-3445ab86><!----><div class="items" data-v-3445ab86><!--[--><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/install-configure.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Docker安装与配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/base-tutorial.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Docker基础教程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/volume-store.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Docker数据卷与持久化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/network.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Docker网络原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/dockerfile.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>使用Dockerfile构建镜像</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/docker-compose.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>使用DockerCompose部署服务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/npm-repository.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>使用Docker搭建npm仓库</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/docker/docker-repository.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>搭建docker私有仓库</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-983e8791><section class="VPSidebarItem level-0 has-active" data-v-983e8791 data-v-3445ab86><div class="item" role="button" tabindex="0" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><h2 class="text" data-v-3445ab86>Gitlab</h2><!----></div><div class="items" data-v-3445ab86><!--[--><section class="VPSidebarItem level-1 has-active" data-v-3445ab86 data-v-3445ab86><!----><div class="items" data-v-3445ab86><!--[--><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/gitlab/install-configure.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>安装与配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/gitlab/gitlab-runner-install-configure.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Gitlab Runner安装与配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/gitlab/gitlab-pipeline.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Gitlab流水线配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/gitlab/npm-repository.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>Gitlab搭建npm仓库</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-983e8791><section class="VPSidebarItem level-0" data-v-983e8791 data-v-3445ab86><div class="item" role="button" tabindex="0" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><h2 class="text" data-v-3445ab86>Kubernetes</h2><!----></div><div class="items" data-v-3445ab86><!--[--><section class="VPSidebarItem level-1" data-v-3445ab86 data-v-3445ab86><!----><div class="items" data-v-3445ab86><!--[--><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/k8s/base.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>初识kubernetes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-3445ab86 data-v-3445ab86><div class="item" data-v-3445ab86><div class="indicator" data-v-3445ab86></div><a class="VPLink link link" href="/fullstack/k8s/install.html" data-v-3445ab86><!--[--><p class="text" data-v-3445ab86>搭建k8s集群</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-e69ff593 data-v-5a285343><div class="VPDoc has-sidebar has-aside" data-v-5a285343 data-v-fb80de84><!--[--><!--]--><div class="container" data-v-fb80de84><div class="aside" data-v-fb80de84><div class="aside-curtain" data-v-fb80de84></div><div class="aside-container" data-v-fb80de84><div class="aside-content" data-v-fb80de84><div class="VPDocAside" data-v-fb80de84 data-v-bb0b59e9><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-bb0b59e9 data-v-ea307b6d><div class="content" data-v-ea307b6d><div class="outline-marker" data-v-ea307b6d></div><div class="outline-title" role="heading" aria-level="2" data-v-ea307b6d>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-ea307b6d><span class="visually-hidden" id="doc-outline-aria-label" data-v-ea307b6d> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-ea307b6d data-v-20500810><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-bb0b59e9></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-fb80de84><div class="content-container" data-v-fb80de84><!--[--><!--]--><main class="main" data-v-fb80de84><div style="position:relative;" class="vp-doc _fullstack_gitlab_gitlab-pipeline external-link-icon-enabled" data-v-fb80de84><div><h1 id="gitlab流水线配置" tabindex="-1">Gitlab流水线配置 <a class="header-anchor" href="#gitlab流水线配置" aria-label="Permalink to &quot;Gitlab流水线配置&quot;">​</a></h1><p>流水线的流程是，提交代码后，gitlab会检测项目根目录里的<code>.github-ci.yml</code>文件，根据文件中的流水线自动构建，配置文件格式正确性可以在gitlab进行文件校验，格式使用yaml文件格式，一个yaml文件就是一个流水线，里面会定义多个作业</p><h2 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-label="Permalink to &quot;示例&quot;">​</a></h2><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">stages</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> install</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> deploy</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F07178;">install_job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;"> stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> install</span></span>
<span class="line"><span style="color:#F07178;"> tags</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> docker</span></span>
<span class="line"><span style="color:#F07178;"> script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> echo install stage</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">build_job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;"> stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;"> script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> echo build stage</span></span>
<span class="line"><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F07178;">deploy_job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;"> stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> deploy</span></span>
<span class="line"><span style="color:#F07178;"> script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;"> -</span><span style="color:#C3E88D;"> echo deploy stage</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="默认变量" tabindex="-1">默认变量 <a class="header-anchor" href="#默认变量" aria-label="Permalink to &quot;默认变量&quot;">​</a></h2><p>gitlab会提供一些默认变量使用，这里列出默认变量</p><p><a href="https://docs.gitlab.com/ee/ci/variables/predefined_variables.html" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/variables/predefined_variables.html</a></p><h3 id="通用变量" tabindex="-1">通用变量 <a class="header-anchor" href="#通用变量" aria-label="Permalink to &quot;通用变量&quot;">​</a></h3><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">GitLab</th><th style="text-align:left;">Runner</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;"><code>CHAT_CHANNEL</code></td><td style="text-align:left;">10.6</td><td style="text-align:left;">all</td><td style="text-align:left;">触发 ChatOps 命令的源聊天频道。</td></tr><tr><td style="text-align:left;"><code>CHAT_INPUT</code></td><td style="text-align:left;">10.6</td><td style="text-align:left;">all</td><td style="text-align:left;">使用 ChatOps 命令传递的附加参数。</td></tr><tr><td style="text-align:left;"><code>CHAT_USER_ID</code></td><td style="text-align:left;">14.4</td><td style="text-align:left;">all</td><td style="text-align:left;">触发 ChatOps 命令的用户的聊天服务用户 ID。</td></tr><tr><td style="text-align:left;"><code>CI</code></td><td style="text-align:left;">all</td><td style="text-align:left;">0.4</td><td style="text-align:left;">适用于在 CI/CD 中执行的所有作业。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_API_V4_URL</code></td><td style="text-align:left;">11.7</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab API v4 根 URL。</td></tr><tr><td style="text-align:left;"><code>CI_BUILDS_DIR</code></td><td style="text-align:left;">all</td><td style="text-align:left;">11.10</td><td style="text-align:left;">执行构建的顶级目录。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_AUTHOR</code></td><td style="text-align:left;">13.11</td><td style="text-align:left;">all</td><td style="text-align:left;"><code>Name &lt;email&gt;</code> 格式的提交作者。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_BEFORE_SHA</code></td><td style="text-align:left;">11.2</td><td style="text-align:left;">all</td><td style="text-align:left;">出现在分支或标签上的上一个最新提交。在合并请求的流水线中总是 <code>0000000000000000000000000000000000000000</code>。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_BRANCH</code></td><td style="text-align:left;">12.6</td><td style="text-align:left;">0.5</td><td style="text-align:left;">提交分支名称。在分支流水线中可用，包括默认分支的流水线。在合并请求流水线或标签流水线中不可用。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_DESCRIPTION</code></td><td style="text-align:left;">10.8</td><td style="text-align:left;">all</td><td style="text-align:left;">提交的描述。如果标题短于 100 个字符，则消息没有第一行。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_MESSAGE</code></td><td style="text-align:left;">10.8</td><td style="text-align:left;">all</td><td style="text-align:left;">完整的提交消息。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_REF_NAME</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">为其构建项目的分支或标签名称。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_REF_PROTECTED</code></td><td style="text-align:left;">11.11</td><td style="text-align:left;">all</td><td style="text-align:left;">如果作业正在运行以获取受保护的 ref 为 <code>true</code> 。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_REF_SLUG</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;"><code>CI_COMMIT_REF_NAME</code> 小写，缩短为 63 字节，除了 <code>0-9</code> 和 <code>a-z</code> 之外的所有内容都替换为 <code>-</code>。没有前导/尾随<code>-</code>。 在 URL、主机名和域名中使用。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_SHA</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">项目为其构建的提交修订。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_SHORT_SHA</code></td><td style="text-align:left;">11.7</td><td style="text-align:left;">all</td><td style="text-align:left;"><code>CI_COMMIT_SHA</code> 的前八个字符。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_TAG</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">0.5</td><td style="text-align:left;">提交标签名称。仅在标签流水线中可用。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_TAG_MESSAGE</code></td><td style="text-align:left;">15.5</td><td style="text-align:left;">all</td><td style="text-align:left;">提交标签消息。仅在标签流水线中可用。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_TIMESTAMP</code></td><td style="text-align:left;">13.4</td><td style="text-align:left;">all</td><td style="text-align:left;">ISO 8601 格式的提交时间戳。</td></tr><tr><td style="text-align:left;"><code>CI_COMMIT_TITLE</code></td><td style="text-align:left;">10.8</td><td style="text-align:left;">all</td><td style="text-align:left;">提交的标题。消息的完整第一行。</td></tr><tr><td style="text-align:left;"><code>CI_CONCURRENT_ID</code></td><td style="text-align:left;">all</td><td style="text-align:left;">11.10</td><td style="text-align:left;">单个 executor 中构建执行的唯一 ID。</td></tr><tr><td style="text-align:left;"><code>CI_CONCURRENT_PROJECT_ID</code></td><td style="text-align:left;">all</td><td style="text-align:left;">11.10</td><td style="text-align:left;">单个 executor 和项目中构建执行的唯一 ID。</td></tr><tr><td style="text-align:left;"><code>CI_CONFIG_PATH</code></td><td style="text-align:left;">9.4</td><td style="text-align:left;">0.5</td><td style="text-align:left;">CI/CD 配置文件的路径。默认为<code>.gitlab-ci.yml</code>。在正在运行的流水线中只读。</td></tr><tr><td style="text-align:left;"><code>CI_DEBUG_TRACE</code></td><td style="text-align:left;">all</td><td style="text-align:left;">1.7</td><td style="text-align:left;">如果 <a href="https://docs.gitlab.cn/jh/ci/variables/index.html#debug-%E6%97%A5%E5%BF%97" target="_blank" rel="noreferrer">debug 日志 (跟踪)</a> 已启用为<code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_DEBUG_SERVICES</code></td><td style="text-align:left;">15.7</td><td style="text-align:left;">15.7</td><td style="text-align:left;"><code>true</code> 如果启用了<a href="https://docs.gitlab.cn/jh/ci/services/index.html#capturing-service-container-logs" target="_blank" rel="noreferrer">服务容器日志</a>，值为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_DEFAULT_BRANCH</code></td><td style="text-align:left;">12.4</td><td style="text-align:left;">all</td><td style="text-align:left;">项目默认分支的名称。</td></tr><tr><td style="text-align:left;"><code>CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">通过 Dependency Proxy 拉取镜像的顶级群组镜像前缀。</td></tr><tr><td style="text-align:left;"><code>CI_DEPENDENCY_PROXY_DIRECT_GROUP_IMAGE_PREFIX</code></td><td style="text-align:left;">14.3</td><td style="text-align:left;">all</td><td style="text-align:left;">通过 Dependency Proxy 拉取镜像的直接群组镜像前缀。</td></tr><tr><td style="text-align:left;"><code>CI_DEPENDENCY_PROXY_PASSWORD</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">通过 Dependency Proxy 拉取镜像的密码。</td></tr><tr><td style="text-align:left;"><code>CI_DEPENDENCY_PROXY_SERVER</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">用于登录 Dependency Proxy 的服务器。相当于 <code>$CI_SERVER_HOST:$CI_SERVER_PORT</code>。</td></tr><tr><td style="text-align:left;"><code>CI_DEPENDENCY_PROXY_USER</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">通过 Dependency Proxy 拉取镜像的用户名。</td></tr><tr><td style="text-align:left;"><code>CI_DEPLOY_FREEZE</code></td><td style="text-align:left;">13.2</td><td style="text-align:left;">all</td><td style="text-align:left;">仅当流水线在部署冻结窗口期间运行时才可用。可用时为 <code>true</code> 。</td></tr><tr><td style="text-align:left;"><code>CI_DEPLOY_PASSWORD</code></td><td style="text-align:left;">10.8</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab Deploy Token 的认证密码，如果项目有的话。</td></tr><tr><td style="text-align:left;"><code>CI_DEPLOY_USER</code></td><td style="text-align:left;">10.8</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab Deploy Token 的认证用户名，如果项目有的话。</td></tr><tr><td style="text-align:left;"><code>CI_DISPOSABLE_ENVIRONMENT</code></td><td style="text-align:left;">all</td><td style="text-align:left;">10.1</td><td style="text-align:left;">仅当作业在一次性环境中执行时才可用（仅为该作业创建并在执行后处理/销毁 - 除 <code>shell</code> 和 <code>ssh</code> 之外的所有 executor）。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_ENVIRONMENT_NAME</code></td><td style="text-align:left;">8.15</td><td style="text-align:left;">all</td><td style="text-align:left;">此作业的环境名称。 如果设置了 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#environmentname" target="_blank" rel="noreferrer"><code>environment:name</code></a>，则可用。</td></tr><tr><td style="text-align:left;"><code>CI_ENVIRONMENT_SLUG</code></td><td style="text-align:left;">8.15</td><td style="text-align:left;">all</td><td style="text-align:left;">环境名称的简化版本，适合包含在 DNS、URL、Kubernetes labels 等。如果设置了 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#environmentname" target="_blank" rel="noreferrer"><code>environment:name</code></a>，则可用。Slug 被截断为 24 个字符。</td></tr><tr><td style="text-align:left;"><code>CI_ENVIRONMENT_URL</code></td><td style="text-align:left;">9.3</td><td style="text-align:left;">all</td><td style="text-align:left;">此作业的环境 URL。如果设置了 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#environmenturl" target="_blank" rel="noreferrer"><code>environment:url</code></a>，则可用。</td></tr><tr><td style="text-align:left;"><code>CI_ENVIRONMENT_ACTION</code></td><td style="text-align:left;">13.11</td><td style="text-align:left;">all</td><td style="text-align:left;">为此作业的环境指定的操作注释。如果设置了 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#environmentaction" target="_blank" rel="noreferrer"><code>environment:action</code></a>，则可用。可以是<code>start</code>、<code>prepare</code> 或 <code>stop</code>。</td></tr><tr><td style="text-align:left;"><code>CI_ENVIRONMENT_TIER</code></td><td style="text-align:left;">14.0</td><td style="text-align:left;">all</td><td style="text-align:left;">此作业的环境部署级别。</td></tr><tr><td style="text-align:left;"><code>CI_RELEASE_DESCRIPTION</code></td><td style="text-align:left;">15.5</td><td style="text-align:left;">all</td><td style="text-align:left;">发布的描述。仅在标签流水线上可用。描述长度限制为前 1024 个字符。</td></tr><tr><td style="text-align:left;"><code>CI_GITLAB_FIPS_MODE</code></td><td style="text-align:left;">14.10</td><td style="text-align:left;">all</td><td style="text-align:left;">实例中是否启用 FIPS 模式的配置设置。</td></tr><tr><td style="text-align:left;"><code>CI_HAS_OPEN_REQUIREMENTS</code></td><td style="text-align:left;">13.1</td><td style="text-align:left;">all</td><td style="text-align:left;">仅当流水线的项目具有打开的<a href="https://docs.gitlab.cn/jh/user/project/requirements/index.html" target="_blank" rel="noreferrer">需求</a> 时才可用。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_ID</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">作业的内部 ID，在 GitLab 实例中的所有作业中是唯一的。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_IMAGE</code></td><td style="text-align:left;">12.9</td><td style="text-align:left;">12.9</td><td style="text-align:left;">运行作业的 Docker 镜像的名称。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_JWT</code></td><td style="text-align:left;">12.10</td><td style="text-align:left;">all</td><td style="text-align:left;">一个 RS256 JSON Web 令牌，用于与支持 JWT 身份验证的第三方系统进行身份验证，例如 <a href="https://docs.gitlab.cn/jh/ci/secrets/index.html" target="_blank" rel="noreferrer">HashiCorp’s Vault</a>。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_JWT_V1</code></td><td style="text-align:left;">14.6</td><td style="text-align:left;">all</td><td style="text-align:left;">与 <code>CI_JOB_JWT</code> 相同的值。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_MANUAL</code></td><td style="text-align:left;">8.12</td><td style="text-align:left;">all</td><td style="text-align:left;">如果作业是手动启动为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_NAME</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">0.5</td><td style="text-align:left;">作业名称</td></tr><tr><td style="text-align:left;"><code>CI_JOB_NAME_SLUG</code></td><td style="text-align:left;">15.4</td><td style="text-align:left;">all</td><td style="text-align:left;"><code>CI_JOB_NAME_SLUG</code> 的小写，缩短为 63 字节，除 <code>0-9</code> 和 <code>a-z</code> 以外的所有内容都替换为 <code>-</code>。没有前导/尾随的 <code>-</code>。在路径中使用。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_STAGE</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">0.5</td><td style="text-align:left;">作业阶段名称</td></tr><tr><td style="text-align:left;"><code>CI_JOB_STATUS</code></td><td style="text-align:left;">all</td><td style="text-align:left;">13.5</td><td style="text-align:left;">执行每个 runner 阶段时的作业状态。与 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#after_script" target="_blank" rel="noreferrer"><code>after_script</code></a> 一起使用。可以是 <code>success</code>，<code>failed</code> 或 <code>canceled</code>。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_TOKEN</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">1.2</td><td style="text-align:left;">使用某些 API 端点进行身份验证的令牌。只要作业正在运行，令牌就有效。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_URL</code></td><td style="text-align:left;">11.1</td><td style="text-align:left;">0.5</td><td style="text-align:left;">作业详细信息 URL。</td></tr><tr><td style="text-align:left;"><code>CI_JOB_STARTED_AT</code></td><td style="text-align:left;">13.10</td><td style="text-align:left;">all</td><td style="text-align:left;">作业开始时的 UTC 日期时间，采用 <a href="https://www.rfc-editor.org/rfc/rfc3339#appendix-A" target="_blank" rel="noreferrer">ISO 8601</a> 格式。</td></tr><tr><td style="text-align:left;"><code>CI_KUBERNETES_ACTIVE</code></td><td style="text-align:left;">13.0</td><td style="text-align:left;">all</td><td style="text-align:left;">仅当流水线具有可用于部署的 Kubernetes 集群时才可用。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_NODE_INDEX</code></td><td style="text-align:left;">11.5</td><td style="text-align:left;">all</td><td style="text-align:left;">作业集中的作业 index。仅当作业使用 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#parallel" target="_blank" rel="noreferrer"><code>parallel</code></a> 时可用。</td></tr><tr><td style="text-align:left;"><code>CI_NODE_TOTAL</code></td><td style="text-align:left;">11.5</td><td style="text-align:left;">all</td><td style="text-align:left;">此作业并行运行的实例总数。如果作业不使用 <a href="https://docs.gitlab.cn/jh/ci/yaml/index.html#parallel" target="_blank" rel="noreferrer"><code>parallel</code></a>，则设置为 <code>1</code>。</td></tr><tr><td style="text-align:left;"><code>CI_OPEN_MERGE_REQUESTS</code></td><td style="text-align:left;">13.8</td><td style="text-align:left;">all</td><td style="text-align:left;">使用当前分支和项目作为合并请求源的最多四个合并请求的逗号分隔列表。如果分支具有关联的合并请求，则仅在分支和合并请求流水线中可用。例如，<code>gitlab-org/gitlab!333,gitlab-org/gitlab-foss!11</code>。</td></tr><tr><td style="text-align:left;"><code>CI_PAGES_DOMAIN</code></td><td style="text-align:left;">11.8</td><td style="text-align:left;">all</td><td style="text-align:left;">托管 GitLab Pages 的配置域名。</td></tr><tr><td style="text-align:left;"><code>CI_PAGES_URL</code></td><td style="text-align:left;">11.8</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab Pages 站点的 URL。始终是 <code>CI_PAGES_DOMAIN</code> 的子域名。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_ID</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">all</td><td style="text-align:left;">当前流水线的实例级 ID。该 ID 在实例上的所有项目中都是唯一的。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_IID</code></td><td style="text-align:left;">11.0</td><td style="text-align:left;">all</td><td style="text-align:left;">当前流水线的项目级 IID（内部 ID）。此 ID 仅在当前项目中是唯一的。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_SOURCE</code></td><td style="text-align:left;">10.0</td><td style="text-align:left;">all</td><td style="text-align:left;">流水线是如何触发的。可以是 <code>push</code>、<code>web</code>、<code>schedule</code>、<code>api</code>、<code>external</code>、<code>chat</code>、<code>webide</code>、<code>merge_request_event</code>、<code>external_pull_request_event</code>、<code>parent_pipeline</code>、<a href="https://docs.gitlab.cn/jh/ci/triggers/index.html#%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E4%BB%A4%E7%89%8C" target="_blank" rel="noreferrer"><code>trigger</code> 或 <code>pipeline </code></a>。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_TRIGGERED</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">如果作业是<a href="https://docs.gitlab.cn/jh/ci/triggers/index.html" target="_blank" rel="noreferrer">触发的</a>为 true。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_URL</code></td><td style="text-align:left;">11.1</td><td style="text-align:left;">0.5</td><td style="text-align:left;">流水线详细信息的 URL。</td></tr><tr><td style="text-align:left;"><code>CI_PIPELINE_CREATED_AT</code></td><td style="text-align:left;">13.10</td><td style="text-align:left;">all</td><td style="text-align:left;">创建流水线时的 UTC 日期时间，采用 <a href="https://tools.ietf.org/html/rfc3339#appendix-A" target="_blank" rel="noreferrer">ISO 8601</a> 格式。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_DIR</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">仓库克隆到的完整路径，以及作业从哪里运行。如果设置了 GitLab Runner <code>builds_dir</code> 参数，这个变量是相对于 <code>builds_dir</code> 的值设置的。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_ID</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">当前项目的 ID。该 ID 在实例上的所有项目中都是唯一的。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_NAME</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">项目目录的名称。例如，如果项目 URL 是 <code>gitlab.example.com/group-name/project-1</code>，则 <code>CI_PROJECT_NAME</code> 是 <code>project-1</code>。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_NAMESPACE</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">作业的项目命名空间（用户名或组名）。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_PATH_SLUG</code></td><td style="text-align:left;">9.3</td><td style="text-align:left;">all</td><td style="text-align:left;"><code>$CI_PROJECT_PATH</code> 小写，不是 <code>a-z</code> 或 <code>0-9</code> 的字符替换为 <code>-</code> 并缩短为 63 字节。 在 URL 和域名中使用。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_PATH</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">包含项目名称的项目命名空间。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_REPOSITORY_LANGUAGES</code></td><td style="text-align:left;">12.3</td><td style="text-align:left;">all</td><td style="text-align:left;">仓库中使用的语言的逗号分隔的小写列表。例如<code>ruby,javascript,html,css</code>。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_ROOT_NAMESPACE</code></td><td style="text-align:left;">13.2</td><td style="text-align:left;">0.5</td><td style="text-align:left;">作业的根项目命名空间（用户名或组名）。例如，如果<code>CI_PROJECT_NAMESPACE</code> 是 <code>root-group/child-group/grandchild-group</code>，则 <code>CI_PROJECT_ROOT_NAMESPACE</code> 是 <code>root-group</code>。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_TITLE</code></td><td style="text-align:left;">12.4</td><td style="text-align:left;">all</td><td style="text-align:left;">Web 界面中显示的人类可读的项目名称。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_DESCRIPTION</code></td><td style="text-align:left;">15.1</td><td style="text-align:left;">all</td><td style="text-align:left;">Web 界面中显示的项目描述。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_URL</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">项目的 HTTP(S) 地址。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_VISIBILITY</code></td><td style="text-align:left;">10.3</td><td style="text-align:left;">all</td><td style="text-align:left;">项目可见性。可以是 <code>internal</code>、<code>private</code> 或 <code>public</code>。</td></tr><tr><td style="text-align:left;"><code>CI_PROJECT_CLASSIFICATION_LABEL</code></td><td style="text-align:left;">14.2</td><td style="text-align:left;">all</td><td style="text-align:left;">项目外部授权分类标记。</td></tr><tr><td style="text-align:left;"><code>CI_REGISTRY_IMAGE</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">项目的 Container Registry 的地址。仅当为项目启用了 Container Registry 时才可用。</td></tr><tr><td style="text-align:left;"><code>CI_REGISTRY_PASSWORD</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">将容器推送到项目的 GitLab Container Registry 的密码。仅当为项目启用了 Container Registry 时才可用。 此密码值与 <code>CI_JOB_TOKEN</code> 相同，并且仅在作业运行时有效。使用 <code>CI_DEPLOY_PASSWORD</code> 长期访问镜像库。</td></tr><tr><td style="text-align:left;"><code>CI_REGISTRY_USER</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">将容器推送到项目的 GitLab Container Registry 的用户名。仅当为项目启用了 Container Registry 时才可用。</td></tr><tr><td style="text-align:left;"><code>CI_REGISTRY</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">GitLab Container Registry 的地址。仅当为项目启用了 Container Registry 时才可用。 如果在镜像库配置中指定了一个值，则此变量包括一个 <code>:port</code> 值。</td></tr><tr><td style="text-align:left;"><code>CI_REPOSITORY_URL</code></td><td style="text-align:left;">9.0</td><td style="text-align:left;">all</td><td style="text-align:left;">克隆 Git 仓库的 URL。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_DESCRIPTION</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">runner 的描述。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_EXECUTABLE_ARCH</code></td><td style="text-align:left;">all</td><td style="text-align:left;">10.6</td><td style="text-align:left;">GitLab Runner 可执行文件的操作系统/架构。可能和 executor 的环境不一样。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_ID</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">正在使用的 runner 的唯一 ID。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_REVISION</code></td><td style="text-align:left;">all</td><td style="text-align:left;">10.6</td><td style="text-align:left;">运行作业的 runner 的修订版。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_SHORT_TOKEN</code></td><td style="text-align:left;">all</td><td style="text-align:left;">12.3</td><td style="text-align:left;">runner 的唯一 ID，用于验证新的作业请求。在 14.9 及更高版本中，令牌包含前缀，并且使用前 17 个字符。在 14.9 版本之前，使用前八个字符。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_TAGS</code></td><td style="text-align:left;">8.10</td><td style="text-align:left;">0.5</td><td style="text-align:left;">以逗号分隔的 runner 标签列表。</td></tr><tr><td style="text-align:left;"><code>CI_RUNNER_VERSION</code></td><td style="text-align:left;">all</td><td style="text-align:left;">10.6</td><td style="text-align:left;">运行作业的 GitLab Runner 的版本。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_HOST</code></td><td style="text-align:left;">12.1</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例 URL 的主机，没有协议或端口。例如<code>gitlab.example.com</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_NAME</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">协调作业的 CI/CD 服务器的名称。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_PORT</code></td><td style="text-align:left;">12.8</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例 URL 的端口，没有主机或协议。例如 <code>8080</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_PROTOCOL</code></td><td style="text-align:left;">12.8</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例 URL 的协议，没有主机或端口。例如 <code>https</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_REVISION</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">计划作业的 GitLab 修订版。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_TLS_CA_FILE</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">包含 TLS CA 证书的文件，用于在 runner 设置中设置 <code>tls-ca-file</code> 时验证极狐GitLab 服务器。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_TLS_CERT_FILE</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">包含 TLS 证书的文件，用于在 runner 设置中设置 <code>tls-ca-file</code> 时验证极狐GitLab 服务器。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_TLS_KEY_FILE</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">包含 TLS 密钥的文件，用于在 runner 设置中设置 <code>tls-ca-file</code> 时验证极狐GitLab 服务器。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_URL</code></td><td style="text-align:left;">12.7</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例的基本 URL，包括协议和端口。 例如<code>https://gitlab.example.com:8080</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_VERSION_MAJOR</code></td><td style="text-align:left;">11.4</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例的主版本。例如，如果版本为 <code>13.6.1</code>，则<code>CI_SERVER_VERSION_MAJOR</code> 为 <code>13</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_VERSION_MINOR</code></td><td style="text-align:left;">11.4</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例的小版本。例如，如果版本为 <code>13.6.1</code>，则<code>CI_SERVER_VERSION_MINOR</code> 为 <code>6</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_VERSION_PATCH</code></td><td style="text-align:left;">11.4</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例的补丁版本。例如，如果版本为 <code>13.6.1</code>，则<code>CI_SERVER_VERSION_PATCH</code> 为 <code>1</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER_VERSION</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">GitLab 实例的完整版本。</td></tr><tr><td style="text-align:left;"><code>CI_SERVER</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">适用于在 CI/CD 中执行的所有作业。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_SHARED_ENVIRONMENT</code></td><td style="text-align:left;">all</td><td style="text-align:left;">10.1</td><td style="text-align:left;">仅当作业在共享环境中执行时才可用（跨 CI/CD 调用持久化的，如 <code>shell</code> 或 <code>ssh</code> executor）。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>GITLAB_CI</code></td><td style="text-align:left;">all</td><td style="text-align:left;">all</td><td style="text-align:left;">适用于在 CI/CD 中执行的所有作业。可用时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>GITLAB_FEATURES</code></td><td style="text-align:left;">10.6</td><td style="text-align:left;">all</td><td style="text-align:left;">可用于实例和许可证的许可功能的逗号分隔列表。</td></tr><tr><td style="text-align:left;"><code>GITLAB_USER_EMAIL</code></td><td style="text-align:left;">8.12</td><td style="text-align:left;">all</td><td style="text-align:left;">开始作业的用户的电子邮件。</td></tr><tr><td style="text-align:left;"><code>GITLAB_USER_ID</code></td><td style="text-align:left;">8.12</td><td style="text-align:left;">all</td><td style="text-align:left;">启动作业的用户的 ID。</td></tr><tr><td style="text-align:left;"><code>GITLAB_USER_LOGIN</code></td><td style="text-align:left;">10.0</td><td style="text-align:left;">all</td><td style="text-align:left;">开始作业的用户的用户名。</td></tr><tr><td style="text-align:left;"><code>GITLAB_USER_NAME</code></td><td style="text-align:left;">10.0</td><td style="text-align:left;">all</td><td style="text-align:left;">启动作业的用户的姓名。</td></tr><tr><td style="text-align:left;"><code>TRIGGER_PAYLOAD</code></td><td style="text-align:left;">13.9</td><td style="text-align:left;">all</td><td style="text-align:left;">webhook 负载。仅当流水线使用 webhook 触发时可用。</td></tr></tbody></table><h3 id="合并请求变量" tabindex="-1">合并请求变量 <a class="header-anchor" href="#合并请求变量" aria-label="Permalink to &quot;合并请求变量&quot;">​</a></h3><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">GitLab</th><th style="text-align:left;">Runner</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_APPROVED</code></td><td style="text-align:left;">14.1</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的批准状态。当<a href="https://docs.gitlab.cn/jh/user/project/merge_requests/approvals/index.html" target="_blank" rel="noreferrer">合并请求批准</a> 可用并且合并请求已被批准时为 <code>true</code>。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_ASSIGNEES</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的指派人用户名的逗号分隔列表。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_ID</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的实例级 ID。这是 GitLab 上所有项目的唯一 ID。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_IID</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的项目级 IID（内部 ID）。此 ID 对于当前项目是唯一的。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_LABELS</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的逗号分隔标签名称。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_MILESTONE</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的里程碑标题。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_PROJECT_ID</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的项目 ID。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_PROJECT_PATH</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的项目路径。例如 <code>namespace/awesome-project</code>。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_PROJECT_URL</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的项目的 URL。例如，<code>http://192.168.10.15:3000/namespace/awesome-project</code>。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_REF_PATH</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的引用路径。例如，<code>refs/merge-requests/1/head</code>。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_SOURCE_BRANCH_NAME</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的源分支名称。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_SOURCE_BRANCH_SHA</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的源分支的 HEAD SHA。该变量在合并请求流水线中为空。SHA 仅存在于<a href="https://docs.gitlab.cn/jh/ci/pipelines/merged_results_pipelines.html" target="_blank" rel="noreferrer">合并结果流水线</a>中。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_SOURCE_PROJECT_ID</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的源项目的 ID。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_SOURCE_PROJECT_PATH</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的源项目路径。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_SOURCE_PROJECT_URL</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的源项目的 URL。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_TARGET_BRANCH_NAME</code></td><td style="text-align:left;">11.6</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的目标分支名称。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_TARGET_BRANCH_PROTECTED</code></td><td style="text-align:left;">15.2</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的目标分支的保护状态。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_TARGET_BRANCH_SHA</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的目标分支的 HEAD SHA。该变量在合并请求流水线中为空。SHA 仅存在于<a href="https://docs.gitlab.cn/jh/ci/pipelines/merged_results_pipelines.html" target="_blank" rel="noreferrer">合并结果流水线</a>中。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_TITLE</code></td><td style="text-align:left;">11.9</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的标题。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_EVENT_TYPE</code></td><td style="text-align:left;">12.3</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求的事件类型。可以是 <code>detached</code>、<code>merged_result</code> 或 <code>merge_train</code>。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_DIFF_ID</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求差异的版本。</td></tr><tr><td style="text-align:left;"><code>CI_MERGE_REQUEST_DIFF_BASE_SHA</code></td><td style="text-align:left;">13.7</td><td style="text-align:left;">all</td><td style="text-align:left;">合并请求差异的基本 SHA。</td></tr></tbody></table><h2 id="流水线" tabindex="-1">流水线 <a class="header-anchor" href="#流水线" aria-label="Permalink to &quot;流水线&quot;">​</a></h2><p>gitlabrunner会通过项目根目录下的<code>.gitlab-ci.yml</code>文件来检测并执行流水线的，那么流水线的执行过程就通过<code>.gitlab-ci.yml</code>文件设置的</p><h3 id="job" tabindex="-1">job <a class="header-anchor" href="#job" aria-label="Permalink to &quot;job&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#job-keywords" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#job-keywords</a></p><p>一个流水线中可以定义多个作业，每个作业的名字必须唯一(不能是关键字)，每个作业独立执行，作业定义了在约束条件下进行相关操作，每个作业必须包含一个script，script以数组的形式存在；如果作业中没有before_script或after_script，若全局有，将会先执行全局的；以<code>.</code> 开头的作业不会被执行，一般用来模板继承</p><p><code>befor_script</code>失败会导致整个作业的失败，其他作业将不会再执行，作业的失败不会影响<code>after_script</code>运行</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">build</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	before_script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;before script&quot;</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;hello job1&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;hello job2&quot;</span></span>
<span class="line"><span style="color:#F07178;">	after_script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;after script&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">deploy</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">hello job2</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	after_script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;after script&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">.deploy</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> deploy</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="stages" tabindex="-1">stages <a class="header-anchor" href="#stages" aria-label="Permalink to &quot;stages&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#stages" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#stages</a></p><p>流水线全局定义作业的执行的阶段，作业按照阶段的顺序执行，统一阶段的作业并行运行，不同阶段的按顺序执行</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">stages</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#C3E88D;"> test</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#C3E88D;"> deploy</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	# ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">build</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> yum install node</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm run test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">depoly_pod</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">deploy</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm publish</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="stage" tabindex="-1">stage <a class="header-anchor" href="#stage" aria-label="Permalink to &quot;stage&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#stage" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#stage</a></p><p>stage是在作业中使用的字段，用来标识当前作业的执行阶段，方便全局的stages进行调度管理，若果一个阶段有多个作业，需要注意配置多个runner，以便可以同时执行多个job</p><aside> 💡 vim /etc/gitlab-runner/config.toml concurrent=10 配置后无需重启 </aside><h3 id="pre-post" tabindex="-1">.pre&amp;.post <a class="header-anchor" href="#pre-post" aria-label="Permalink to &quot;.pre&amp;.post&quot;">​</a></h3><p>.pre始终是整个流水线第一个运行的作业，.post始终是整个流水线最后运行的作业。用户定义的阶段都在两者之间运行，.pre和.post的顺序无法更改，如果流水线中仅包含.pre和.post作业，整个流水线将不会执行</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#F07178;"> stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> .pre</span></span>
<span class="line"><span style="color:#F07178;">	tags</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;">	only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> master</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;test...&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="variables" tabindex="-1">variables <a class="header-anchor" href="#variables" aria-label="Permalink to &quot;variables&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#variables" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#variables</a></p><p>定义变量，pipeline、job变量，job变量的优先级大</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	DOMIAN</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> blog.domain.cc</span></span>
<span class="line"><span style="color:#BABED8;">	</span></span>
<span class="line"><span style="color:#F07178;">job1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">build</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">	variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		NAME</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> k8s</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;$DOMAIN&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo &quot;$NAME&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="tags" tabindex="-1">tags <a class="header-anchor" href="#tags" aria-label="Permalink to &quot;tags&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#tags" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#tags</a></p><p>用于从允许运行该项目中的所有runner列表中选择指定的runner，在runner注册期间，可以指定runner标签，标签可以指定多个</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	tags</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> k8s</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> windows</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">		# ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	tags</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> k8s</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> docker</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="allow-failure" tabindex="-1">allow_failure <a class="header-anchor" href="#allow-failure" aria-label="Permalink to &quot;allow_failure&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#allow_failure" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#allow_failure</a></p><p>允许作业失败，默认值false，启动后，如果作业运行失败，改作业将会在用户界面中显示橙色警告，但是，整个流水将认为作业通过，并且不会阻塞后面的作业执行</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	allow_failure</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> true</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo 22</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/image-20230318104441601.png" alt="image-20230318104441601"></p><h3 id="when" tabindex="-1">when <a class="header-anchor" href="#when" aria-label="Permalink to &quot;when&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#when" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#when</a></p><p>控制作业的运行，指定作业什么状态下才会执行，选项值：</p><ul><li>on_success：前面阶段中的所有作业都成功时才会执行(默认值)</li><li>on_failure：当前面阶段出现失败时执行</li><li>always：总是执行作业</li><li>manual：手动执行作业</li><li>delayed：延迟执行作业</li></ul><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> on_success</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> delayed</span></span>
<span class="line"><span style="color:#F07178;">	start_in</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">20</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job3</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> manaul</span><span style="color:#676E95;font-style:italic;"> # 手动执行，比如手动发布</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="retry" tabindex="-1">retry <a class="header-anchor" href="#retry" aria-label="Permalink to &quot;retry&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#retry" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#retry</a></p><p>设置作业失败情况下重试的次数，只能设置正整数(0≤n≤2)，最大设置次数2，也就是重试2次，总共运行3次</p><p>可以在指定类型失败情况下重试，达到精确匹配</p><ul><li><code>always</code>: Retry on any failure (default).</li><li><code>unknown_failure</code>: Retry when the failure reason is unknown.</li><li><code>script_failure</code>: Retry when the script failed.</li><li><code>api_failure</code>: Retry on API failure.</li><li><code>stuck_or_timeout_failure</code>: Retry when the job got stuck or timed out.</li><li><code>runner_system_failure</code>: Retry if there is a runner system failure (for example, job setup failed).</li><li><code>runner_unsupported</code>: Retry if the runner is unsupported.</li><li><code>stale_schedule</code>: Retry if a delayed job could not be executed.</li><li><code>job_execution_timeout</code>: Retry if the script exceeded the maximum execution time set for the job.</li><li><code>archived_failure</code>: Retry if the job is archived and can’t be run.</li><li><code>unmet_prerequisites</code>: Retry if the job failed to complete prerequisite tasks.</li><li><code>scheduler_failure</code>: Retry if the scheduler failed to assign the job to a runner.</li><li><code>data_integrity_failure</code>: Retry if there is a structural integrity problem detected.</li></ul><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	retry</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	retry</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> api_failure</span></span>
<span class="line"><span style="color:#F07178;">		max</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job3</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	retry</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		when</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> api_failure</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> scheduler_failure</span></span>
<span class="line"><span style="color:#F07178;">		max</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="timeout" tabindex="-1">timeout <a class="header-anchor" href="#timeout" aria-label="Permalink to &quot;timeout&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#timeout" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#timeout</a></p><p>作业级别的超时，可以超过项目级别的超时，但不能超过runner特定的超时</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	timeout</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> 2h 30m</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="parallel" tabindex="-1">parallel <a class="header-anchor" href="#parallel" aria-label="Permalink to &quot;parallel&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#parallel" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#parallel</a></p><p>配置要并行运行的作业实例数，此值必须大于或等于2并且小于等于50，这将创建N个并行运行的统一作业的实例，他们从job_name 1/N到job_name N/N依次命名</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	parallel</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="only-except" tabindex="-1">only/except <a class="header-anchor" href="#only-except" aria-label="Permalink to &quot;only/except&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#only--except" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#only--except</a></p><p>only和except用分支策略来限制jobs的构建</p><ul><li>only定义哪些分支和标签的git项目将会被执行job</li><li>except定义哪些分支和标签的git项目将不会执行job</li></ul><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> master</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="rules" tabindex="-1">rules <a class="header-anchor" href="#rules" aria-label="Permalink to &quot;rules&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#rules" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#rules</a></p><p>rules允许按顺序评估单个规则，知道匹配并作为动态提供属性，不能与only/except组合使用</p><ul><li>if</li><li>changes</li><li>exists</li><li>allow_failure</li><li>variables</li><li>when</li></ul><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	DOMAIN</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> example.com</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	rules</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		if</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">$DOMAIN == &quot;example.com&quot;</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> manual</span></span>
<span class="line"><span style="color:#F07178;">		allow_failure</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	rules</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		if</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME =~ /^feature/ &amp;&amp; $CI_MERGE_REQUEST_TARGET_BRANCH_NAME != $CI_DEFAULT_BRANCH</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> never</span></span>
<span class="line"><span style="color:#F07178;">		if</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME =~ /^feature/</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> manual</span></span>
<span class="line"><span style="color:#F07178;">		allow_failure</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="workflow" tabindex="-1">workflow <a class="header-anchor" href="#workflow" aria-label="Permalink to &quot;workflow&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#workflow" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#workflow</a></p><p>顶级workflow关键字适用于整个管道，并确定是否创建管道，when：可以设置always和never，如果未提供，则默认值always</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	DOMAIN</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> example.com</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">workflow</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	rules</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		if</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">$DOMAIN == &quot;example.com&quot;</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> never</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> always</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="cache" tabindex="-1">cache <a class="header-anchor" href="#cache" aria-label="Permalink to &quot;cache&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#cache" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#cache</a></p><p>使用缓存指定要在作业之间缓存的文件和目录列表。只能使用本地工作包中的路径；管道和工作之间共享缓存。在<a href="https://docs.gitlab.com/ee/ci/yaml/#artifacts" target="_blank" rel="noreferrer">artifacts</a>之前恢复缓存。</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">cache</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	paths</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> .yarn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	tag</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;">	cache</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		key</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> cache-build</span></span>
<span class="line"><span style="color:#F07178;">		paths</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> dist</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> public</span></span>
<span class="line"><span style="color:#F07178;">		policy</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> pull</span><span style="color:#676E95;font-style:italic;"> # 不下载缓存</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	cache</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		key</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">			files</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">				-</span><span style="color:#C3E88D;"> package.json</span></span>
<span class="line"><span style="color:#89DDFF;">				-</span><span style="color:#C3E88D;"> yarn.lock</span></span>
<span class="line"><span style="color:#F07178;">		paths</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> public</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="artifacts" tabindex="-1">artifacts <a class="header-anchor" href="#artifacts" aria-label="Permalink to &quot;artifacts&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#artifacts" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#artifacts</a></p><p>用于指定在作业成功或失败时应附加到作业的文件或目录列表，作业完成后，工件将被发送至gitlab，并可在gitlab对应的ci/cd中下载</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> ls</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> pwd</span></span>
<span class="line"><span style="color:#F07178;">	artifacts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">$CI_JOB_NAME</span><span style="color:#89DDFF;">&#39;</span><span style="color:#676E95;font-style:italic;">  # 默认 artifacts.zip</span></span>
<span class="line"><span style="color:#F07178;">		exclude</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> node_modules/**</span></span>
<span class="line"><span style="color:#F07178;">		paths</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> dist</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> public</span></span>
<span class="line"><span style="color:#F07178;">		expose_as</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">artifact 1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#676E95;font-style:italic;"> # 合并时暴露工件</span></span>
<span class="line"><span style="color:#F07178;">		expire_in</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> 1 day</span><span style="color:#676E95;font-style:italic;">  # 默认30天会清除掉</span></span>
<span class="line"><span style="color:#F07178;">		reports</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;"> # 单元测试报告</span></span>
<span class="line"><span style="color:#F07178;">			jest</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> report.xml</span></span>
<span class="line"><span style="color:#F07178;">		when</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> on_success</span></span>
<span class="line"><span style="color:#F07178;">	only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> tags</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">depoly</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	dependencies</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;"> # 使用工件</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> build</span><span style="color:#676E95;font-style:italic;"> # job name</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="dependencies" tabindex="-1">dependencies <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;dependencies&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#dependencies" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#dependencies</a></p><p>定义获取工件的作业列表，只能从当前阶段之前执行的阶段定义作业，定义一个空数组将跳过下载该作业的任何工件不会考虑先前作业的状态，因此，如果它失败或是未运行的手动作业，则不会发生错误，如果设置为依赖项的作业的工件已过期或删除，那么依赖作业将失败</p><h3 id="needs" tabindex="-1">needs <a class="header-anchor" href="#needs" aria-label="Permalink to &quot;needs&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#needs" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#needs</a></p><p>可无序执行作业，无需按照阶段运行某些作业，可以让多个阶段同时运行</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">stages</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#C3E88D;"> test</span></span>
<span class="line"><span style="color:#F07178;">build1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> ls</span></span>
<span class="line"><span style="color:#F07178;">build2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> pwd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">test1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> test</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm run test</span></span>
<span class="line"><span style="color:#F07178;">	needs</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">build1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;font-style:italic;"> # job name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">test2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> test2</span></span>
<span class="line"><span style="color:#F07178;">	needs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#F07178;"> job</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">build2</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">			artifacts</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="include" tabindex="-1">include <a class="header-anchor" href="#include" aria-label="Permalink to &quot;include&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#include" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#include</a></p><p>可以将相同的配置单独写出，在项目配置文件中引入</p><ul><li>local：本地当前项目当前分支的文件</li><li>file：gitlab其他项目其他分支的某个文件</li><li>remote：远程文件，<a href="http://example.com/xxx/.gitlab-ci.yml" target="_blank" rel="noreferrer">http://example.com/xxx/.gitlab-ci.yml</a></li><li>template：使用官方的模板，<a href="https://gitlab.com/gitlab-org/gitlab/-/tree/master/lib/gitlab/ci/templates" target="_blank" rel="noreferrer">https://gitlab.com/gitlab-org/gitlab/-/tree/master/lib/gitlab/ci/templates</a></li></ul><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#676E95;font-style:italic;"># deploy.yml</span></span>
<span class="line"><span style="color:#F07178;">deploy</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> deploy</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> echo deploy</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># .gitlab-ci.yml</span></span>
<span class="line"><span style="color:#F07178;">include</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	local</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">deploy.yml</span><span style="color:#89DDFF;">&#39;</span><span style="color:#676E95;font-style:italic;"> # 当前项目当前分支下的文件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	# file</span></span>
<span class="line"><span style="color:#F07178;">	project</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> fontend/web-demo</span><span style="color:#676E95;font-style:italic;"> # gitlab下指定的项目</span></span>
<span class="line"><span style="color:#F07178;">	ref</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> master</span><span style="color:#676E95;font-style:italic;">  # 分支</span></span>
<span class="line"><span style="color:#F07178;">	file</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> .gitlab-ci.yml</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	# template 使用官方的模板</span></span>
<span class="line"><span style="color:#F07178;">	template</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> npm.gitlab-ci.yml</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">	# remote</span></span>
<span class="line"><span style="color:#F07178;">	remote</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> &lt;http://example.com/xx/.gitlab-ci.yml&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="extends" tabindex="-1">extends <a class="header-anchor" href="#extends" aria-label="Permalink to &quot;extends&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#extends" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#extends</a></p><p>继承其他作业的配置</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">.tests</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">  script</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> rake test</span></span>
<span class="line"><span style="color:#F07178;">  stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> test</span></span>
<span class="line"><span style="color:#F07178;">  only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">    refs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">      -</span><span style="color:#C3E88D;"> branches</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">rspec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">  extends</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> .tests</span></span>
<span class="line"><span style="color:#F07178;">  script</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> rake rspec</span></span>
<span class="line"><span style="color:#F07178;">  only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">    variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">      -</span><span style="color:#C3E88D;"> $RSPEC</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="trigger" tabindex="-1">trigger <a class="header-anchor" href="#trigger" aria-label="Permalink to &quot;trigger&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#trigger" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#trigger</a></p><p>多项目管道、父子管道</p><h3 id="image" tabindex="-1">image <a class="header-anchor" href="#image" aria-label="Permalink to &quot;image&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#image" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#image</a></p><p>默认在注册runner的时候需要填写一个基础镜像，只要使用执行器为docker类型的runner所有的操作运行都会在容器中运行，如果全局指定了image则所有的job使用此image创建容器并在其中运行，全局未指定image，再次检查job中是否指定，如果有此job按照指定镜像创建容器并执行，没有则使用注册runner时指定的默认镜像</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#C3E88D;">	node:alpine</span></span>
<span class="line"><span style="color:#F07178;">	entrypoint</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node -v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	stage</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> build</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm install</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm run build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="services" tabindex="-1">services <a class="header-anchor" href="#services" aria-label="Permalink to &quot;services&quot;">​</a></h3><p>工作期间运行的另一个docker镜像，并link到image关键字定义的docker镜像，这样就可以在构建期间访问服务镜像，服务镜像可以运行任何应用程序，但是最常见的是运行数据库容器，</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	node</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">	-</span><span style="color:#F07178;"> name</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> mysql:latest</span></span>
<span class="line"><span style="color:#F07178;">		alias</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> mysql</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="environment" tabindex="-1">environment <a class="header-anchor" href="#environment" aria-label="Permalink to &quot;environment&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#environment" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#environment</a></p><p>定义job发布的环境</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">depoly</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	scripts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm login</span></span>
<span class="line"><span style="color:#89DDFF;">		-</span><span style="color:#C3E88D;"> npm publish</span></span>
<span class="line"><span style="color:#F07178;">	environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		name</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> production</span></span>
<span class="line"><span style="color:#F07178;">		url</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> &lt;https://www.baidu.com&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="inherit" tabindex="-1">inherit <a class="header-anchor" href="#inherit" aria-label="Permalink to &quot;inherit&quot;">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/#inherit" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/#inherit</a></p><p>使用或禁用全局定义的环境变量或默认值</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight vp-code"><code><span class="line"><span style="color:#F07178;">default</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	retry</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span></span>
<span class="line"><span style="color:#F07178;">	image</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> node:alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	NODE_VERSION</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 16.2.1</span></span>
<span class="line"><span style="color:#F07178;">	USER_NAME</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> root</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> echo hello</span></span>
<span class="line"><span style="color:#F07178;">	inherit</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		default</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> false</span><span style="color:#676E95;font-style:italic;"> # 禁止使用default变量</span></span>
<span class="line"><span style="color:#F07178;">		variables</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> NODE_VERSION</span><span style="color:#676E95;font-style:italic;"> # 继承变量 NODE_VERSION</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">	script</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> echo job2</span></span>
<span class="line"><span style="color:#F07178;">	inherit</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#F07178;">		default</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">			-</span><span style="color:#C3E88D;"> retry</span><span style="color:#676E95;font-style:italic;"> # 继承retry</span></span>
<span class="line"><span style="color:#F07178;">		variables</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> false</span><span style="color:#676E95;font-style:italic;"> # 禁止使用variables变量</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="参考文档" tabindex="-1">参考文档 <a class="header-anchor" href="#参考文档" aria-label="Permalink to &quot;参考文档&quot;">​</a></h2><ul><li><a href="https://docs.gitlab.com/ee/ci/" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/</a></li><li><a href="https://docs.gitlab.com/ee/ci/yaml/" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/ci/yaml/</a></li></ul><!--[--><div class="reward-divider"></div><figure><figcaption> 若您在阅读过程中发现一些错误：如语句不通、文字、逻辑等错误，可以在评论区指出，我会及时调整修改，感谢您的阅读。同时您觉得这篇文章对您有帮助的话，可以打赏作者一笔作为鼓励，金额不限，感谢支持🤝。 </figcaption><div style="text-align:center;margin-top:2em;"><img style="display:inline;" src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/005HV6Avgy1h72anu40usj30dw0dw40j.jpg" width="200" alt="支付宝捐赠"><img style="display:inline;" src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/005HV6Avgy1h72ap99ym1j30b40b4abq.jpg" width="200" alt="微信支付捐赠"></div></figure><div class="reward-divider"></div><div class="share_wrap"><a href="#" target="_blank"><img src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/icon-weibo.png" alt="share to weibo" title="分享到微博"></a><a href="#" target="_blank"><img src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/icon-twitter.png" alt="share to twitter" title="分享到twitter"></a><a href="#" target="_blank"><img src="https://ihengshuai-demo1.oss-cn-beijing.aliyuncs.com/icon-facebook.png" alt="share to facebook" title="分享到facebook"></a></div><!--]--><!----></div></div></main><footer class="VPDocFooter" data-v-fb80de84 data-v-a4d10c8e><!--[--><!--]--><div class="edit-info" data-v-a4d10c8e><!----><div class="last-updated" data-v-a4d10c8e><p class="VPLastUpdated" data-v-a4d10c8e data-v-86563300>最近更新: <time datetime="2024-03-03T04:31:19.000Z" data-v-86563300></time></p></div></div><nav class="prev-next" data-v-a4d10c8e><div class="pager" data-v-a4d10c8e><a class="VPLink link pager-link prev" href="/fullstack/gitlab/gitlab-runner-install-configure.html" data-v-a4d10c8e><!--[--><span class="desc" data-v-a4d10c8e>Previous page</span><span class="title" data-v-a4d10c8e>Gitlab Runner安装与配置</span><!--]--></a></div><div class="pager" data-v-a4d10c8e><a class="VPLink link pager-link next" href="/fullstack/gitlab/npm-repository.html" data-v-a4d10c8e><!--[--><span class="desc" data-v-a4d10c8e>Next page</span><span class="title" data-v-a4d10c8e>Gitlab搭建npm仓库</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-e69ff593 data-v-e09097b5><div class="container" data-v-e09097b5><p class="message" data-v-e09097b5>Released under the MIT License.</p><p class="copyright" data-v-e09097b5>Copyright © 2018-2024 HengShuai</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"frontend_babel_babel-analysis.md\":\"wGpC9j4r\",\"frontend_babel_babel-plugin-guide.md\":\"ppFJFpUc\",\"frontend_babel_base.md\":\"vrUaWuJ_\",\"frontend_base.md\":\"dwQglb_Z\",\"frontend_browser_base.md\":\"8v9kmWYQ\",\"frontend_building-tool_base.md\":\"IZjj-1k_\",\"frontend_canvas_base.md\":\"4FFeOXMN\",\"frontend_canvas_magic-effects.md\":\"d72-kJZY\",\"frontend_cli_index.md\":\"LW95mYz4\",\"frontend_compiler_index.md\":\"kb3LvP4F\",\"article_2021_vue-img-lazyload.md\":\"nS2xctKa\",\"frontend_computer-network_arp-protocol.md\":\"Kq6yx99o\",\"article_2020_vscode-shortcut.md\":\"9YPtkAQd\",\"article_2020_web-cache.md\":\"tgnHisxs\",\"article_2019_mysql-guide.md\":\"sVywMOTl\",\"article_2021_pwa-app.md\":\"OleMbyZc\",\"article_2021_vue-core-process.md\":\"lvBKNU2P\",\"article_2019_js-type-transfer.md\":\"6bgN44L7\",\"frontend_computer-network_base.md\":\"rscsR2cq\",\"article_base.md\":\"MRVl6scQ\",\"article_2022_emoji-markup.md\":\"OhV-I-1u\",\"article_2019_what-bfc.md\":\"3X8ih4fR\",\"article_2021_ts-decorator.md\":\"t9oGw5oN\",\"article_2020_webpack-guide.md\":\"4hgG0rTv\",\"article_2021_js-pattern.md\":\"s7bHowR9\",\"article_2021_flex-layout.md\":\"Svx6-bGi\",\"article_2019_nvm-guide.md\":\"DOn-ZyKp\",\"article_2019_ktv-system.md\":\"8zwU_3Hs\",\"article_2020_optimize-web-server.md\":\"zI4x4pon\",\"article_2019_css-center.md\":\"39T7ILEY\",\"article_2020_domparser-xml.md\":\"14rZ0LzC\",\"frontend_nginx_base.md\":\"zoU8TEMt\",\"article_2019_promise.md\":\"PPpH3Goo\",\"article_2019_bind-call-apply.md\":\"sKjhWUC_\",\"article_2019_js-copy.md\":\"aASz1f6e\",\"article_2020_regexp-guide.md\":\"Hz2CcED7\",\"article_2021_performance-tools.md\":\"f1ArMVK_\",\"frontend_performance_chunk-upload.md\":\"_H6a4GPM\",\"frontend_performance_load-perf.md\":\"GBvTUzYN\",\"frontend_performance_network-perf.md\":\"5sGmco83\",\"frontend_performance_cache.md\":\"GADg4UGM\",\"frontend_performance_performance.md\":\"eTHaQNUO\",\"frontend_performance_range-download.md\":\"hDSmWOR2\",\"frontend_performance_secure-perf.md\":\"1SJRKrnr\",\"frontend_performance_seo.md\":\"nVWyT-cr\",\"frontend_performance_virtual-scroll-1.md\":\"GMhzOTOC\",\"frontend_performance_virtual-scroll-2.md\":\"Tf9Xw2tC\",\"frontend_performance_web-score.md\":\"t6trh2aX\",\"frontend_project-integration_base.md\":\"H9p7xZIC\",\"frontend_project-integration_build-tool.md\":\"YEHYzLz2\",\"frontend_debug-skill_base.md\":\"ardgOXee\",\"frontend_debug-skill_charles.md\":\"c860e4Ce\",\"frontend_debug-skill_chrome.md\":\"VolKnY9H\",\"frontend_computer-network_ip-protocol.md\":\"cYsrbBjs\",\"frontend_project-integration_debugger-skill.md\":\"gdFZBkWV\",\"frontend_project-integration_deploy-specification.md\":\"TAZbHJxr\",\"frontend_project-integration_framework.md\":\"5X0ugAP5\",\"frontend_project-integration_git-commit.md\":\"hau9b8OP\",\"frontend_project-integration_monorepo.md\":\"vk1tlUoK\",\"frontend_project-integration_specification.md\":\"FUpSWKJb\",\"frontend_project-integration_style.md\":\"6YvYxYxO\",\"frontend_react_index.md\":\"WCWdbrtn\",\"frontend_regexp_base.md\":\"bxZXRG-x\",\"frontend_render-mode_base.md\":\"awKqNZtj\",\"frontend_sandbox_index.md\":\"gXXOpt2O\",\"frontend_ts_base.md\":\"EsuvODQ8\",\"frontend_vue_computed-watch.md\":\"ViMqGS60\",\"frontend_vue_pinia.md\":\"sFmcIG8v\",\"frontend_vue_router.md\":\"oywyEaoK\",\"frontend_vue_slot.md\":\"-cpDvOd1\",\"frontend_vue_template-compiler.md\":\"BoDuPu-F\",\"frontend_vue_transition.md\":\"oLOqknqJ\",\"frontend_debug-skill_h5.md\":\"JqHXkiol\",\"frontend_vue_update-process.md\":\"k6l2RNx4\",\"frontend_debug-skill_vscode.md\":\"bJXMRiLv\",\"frontend_vue_vuex.md\":\"mDVwtyM1\",\"frontend_wasm_base.md\":\"wKzjPpun\",\"frontend_debug-skill_wireshark.md\":\"h-Af8Z2N\",\"frontend_desktop-app_index.md\":\"CwmxVITt\",\"frontend_webpack_webpack-analysis.md\":\"B7vs5RGV\",\"frontend_editor_index.md\":\"Z3QRmU7I\",\"frontend_webpack_webpack-loader.md\":\"H5WVjPyO\",\"frontend_js_async.md\":\"xM2atz8E\",\"frontend_node-bff_index.md\":\"uvIlJlnt\",\"frontend_js_audio.md\":\"SxVGBXDx\",\"frontend_webpack_webpack-node.md\":\"wv3teGYs\",\"frontend_js_base.md\":\"xDEIN0Le\",\"frontend_webpack_webpack-plugin.md\":\"9tSSq7pn\",\"fullstack_base.md\":\"I4wE93qI\",\"fullstack_docker_base-tutorial.md\":\"9ZJDDyO1\",\"fullstack_docker_docker-compose.md\":\"zjlwGtUy\",\"frontend_js_binary.md\":\"APMVe8ro\",\"fullstack_docker_docker-repository.md\":\"wBmXzDQl\",\"frontend_js_eventloop.md\":\"F1aGIeQj\",\"frontend_js_implicit-conversion.md\":\"z9evaHOi\",\"fullstack_docker_dockerfile.md\":\"3YPLdvgt\",\"frontend_js_js-gc.md\":\"zQJ4SnO7\",\"frontend_js_meta-coding.md\":\"doArwweu\",\"fullstack_docker_install-configure.md\":\"ycQmqQb6\",\"frontend_lowcoding_base.md\":\"1AMtoVOM\",\"frontend_micro-frontend_base.md\":\"VCogbXGF\",\"frontend_monitor_base.md\":\"1PrBd---\",\"fullstack_docker_network.md\":\"sG-Vuzgw\",\"fullstack_docker_npm-repository.md\":\"xNRdDnzE\",\"fullstack_docker_volume-store.md\":\"AmWixEc_\",\"frontend_nestjs_swagger.md\":\"Miz3IuZP\",\"fullstack_gitlab_gitlab-pipeline.md\":\"2PnzZMhY\",\"fullstack_gitlab_gitlab-runner-install-configure.md\":\"AcLdY8_f\",\"fullstack_gitlab_install-configure.md\":\"hsqEggJv\",\"frontend_nestjs_base.md\":\"GEmB31Yt\",\"frontend_nestjs_mvc.md\":\"G7xy_a_Y\",\"frontend_nestjs_useful.md\":\"5BxCDwjN\",\"frontend_node-optimize_index.md\":\"9iTkxv8U\",\"frontend_node_base.md\":\"f045EATv\",\"frontend_node_node-debug.md\":\"VzMrpiGN\",\"fullstack_k8s_install.md\":\"shPzlnU9\",\"frontend_node_node-web.md\":\"BA0Qp_xe\",\"frontend_performance_node-score.md\":\"GHFkv_LH\",\"frontend_npm_index.md\":\"cPGRzDNd\",\"frontend_performance_base.md\":\"boqnWWao\",\"frontend_performance_cache-perf.md\":\"c67R59ai\",\"index.md\":\"DNChHY-j\",\"me.md\":\"9KzOPl0U\",\"super-nav_index.md\":\"sa1sp0Lq\",\"talk_2023_dad-foot-injured.md\":\"e316_81h\",\"talk_2023_lose-qoo-job.md\":\"wc9xrS2F\",\"talk_2023_love-4th-anniversary.md\":\"EL8i9jjc\",\"talk_2023_second-covid.md\":\"DQ3RHk2a\",\"talk_base.md\":\"bc9zk1r_\",\"frontend_computer-network_http-protocol.md\":\"bfrkeSkr\",\"frontend_project-integration_choose-editor.md\":\"0gNbjQse\",\"frontend_project-integration_ci-pipeline.md\":\"qrLOyYjp\",\"frontend_flutter_base.md\":\"yyvMr_gq\",\"frontend_node_node-framework.md\":\"G8o8zeYS\",\"frontend_debug-skill_fiddler.md\":\"NqneAeW9\",\"frontend_js_proto-inherit.md\":\"E5dVTnVb\",\"frontend_micro-program_index.md\":\"yyQYNhB6\",\"frontend_vue_reactivity.md\":\"9xkgqhJY\",\"frontend_webpack_base.md\":\"C2knYA00\",\"frontend_hybrid-app_base.md\":\"-Vm4xYDr\",\"frontend_node_node-measure.md\":\"4GqjVgP8\",\"frontend_node_node-process.md\":\"Ps4VtoHq\",\"frontend_project-integration_test-framework.md\":\"zZle5pVy\",\"frontend_computer-network_tcp-protocol.md\":\"fep1PHVR\",\"frontend_ts_ts-configure.md\":\"rAao85Hb\",\"frontend_visual_index.md\":\"qSiOl_Sl\",\"frontend_vue_component-render.md\":\"ZCTZuvWu\",\"frontend_js_scope-closure.md\":\"5EWzSuzB\",\"fullstack_k8s_base.md\":\"3Tzy-t_S\",\"fullstack_gitlab_npm-repository.md\":\"vjG8GM3X\",\"frontend_pattern_base.md\":\"GAbsFqbU\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"hengshuai's blog\",\"description\":\"大家好我是卫恒帅，这是我的个人博客，在这里我会分享web开发相关技能经验，也有自己的一些生活所思所悟，希望对你有所帮助，如你感觉不错可以将本站收藏！\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"dark\",\"themeConfig\":{\"externalLinkIcon\":true,\"logoLink\":\"/\",\"siteTitle\":\"Hengshuai's blog\",\"outline\":[2,3],\"outlineTitle\":\"目录\",\"nav\":[{\"text\":\"Frontend\",\"link\":\"/frontend/base.html\",\"activeMatch\":\"/frontend/base\"},{\"text\":\"Fullstack\",\"link\":\"/fullstack/base.html\",\"activeMatch\":\"/fullstack/base\"},{\"text\":\"Article\",\"link\":\"/article/base.html\",\"activeMatch\":\"/article/base\"},{\"text\":\"Case\",\"link\":\"https://case.usword.cn\"},{\"text\":\"Me\",\"link\":\"/me.html\",\"activeMatch\":\"/me\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/ihengshuai\"}],\"sidebar\":{\"/frontend/\":[{\"collapsible\":true,\"items\":[{\"text\":\"Javascript\",\"collapsed\":false,\"link\":\"/frontend/js/base.html\",\"items\":[{\"text\":\"原型、原型链与继承\",\"link\":\"/frontend/js/proto-inherit.html\"},{\"text\":\"作用域(链)、执行上下文及闭包\",\"link\":\"/frontend/js/scope-closure.html\"},{\"text\":\"类型隐式转换\",\"link\":\"/frontend/js/implicit-conversion.html\"},{\"text\":\"事件循环(EventLoop)\",\"link\":\"/frontend/js/eventloop.html\"},{\"text\":\"异步编程\",\"link\":\"/frontend/js/async.html\"},{\"text\":\"元编程\",\"link\":\"/frontend/js/meta-coding.html\"},{\"text\":\"二进制\",\"link\":\"/frontend/js/binary.html\"},{\"text\":\"音视频\",\"link\":\"/frontend/js/audio.html\"},{\"text\":\"垃圾回收\",\"link\":\"/frontend/js/js-gc.html\"}]},{\"text\":\"Browser\",\"link\":\"/frontend/browser/base.html\"},{\"text\":\"Vue\",\"collapsed\":true,\"items\":[{\"text\":\"响应式原理\",\"link\":\"/frontend/vue/reactivity.html\"},{\"text\":\"计算属性与侦听函数\",\"link\":\"/frontend/vue/computed-watch.html\"},{\"text\":\"模板编译\",\"link\":\"/frontend/vue/template-compiler.html\"},{\"text\":\"组件创建与渲染\",\"link\":\"/frontend/vue/component-render.html\"},{\"text\":\"视图更新流程\",\"link\":\"/frontend/vue/update-process.html\"},{\"text\":\"插槽原理\",\"link\":\"/frontend/vue/slot.html\"},{\"text\":\"实现过渡\",\"link\":\"/frontend/vue/transition.html\"},{\"text\":\"vuex内幕\",\"link\":\"/frontend/vue/vuex.html\"},{\"text\":\"pinia原理\",\"link\":\"/frontend/vue/pinia.html\"},{\"text\":\"路由实现\",\"link\":\"/frontend/vue/router.html\"}]},{\"text\":\"Regexp\",\"link\":\"/frontend/regexp/base.html\"},{\"text\":\"Babel\",\"collapsed\":true,\"items\":[{\"text\":\"基本使用\",\"link\":\"/frontend/babel/base.html\"},{\"text\":\"原理分析\",\"link\":\"/frontend/babel/babel-analysis.html\"},{\"text\":\"自定义插件\",\"link\":\"/frontend/babel/babel-plugin-guide.html\"}]},{\"text\":\"Webpack\",\"collapsed\":true,\"items\":[{\"text\":\"基本使用\",\"link\":\"/frontend/webpack/base.html\"},{\"text\":\"自定义loader\",\"link\":\"/frontend/webpack/webpack-loader.html\"},{\"text\":\"自定义插件\",\"link\":\"/frontend/webpack/webpack-plugin.html\"},{\"text\":\"结合node使用\",\"link\":\"/frontend/webpack/webpack-node.html\"},{\"text\":\"原理分析\",\"link\":\"/frontend/webpack/webpack-analysis.html\"}]},{\"text\":\"Building Tool\",\"link\":\"/frontend/building-tool/base.html\"},{\"text\":\"Debug Skill\",\"collapsed\":true,\"link\":\"/frontend/debug-skill/base.html\",\"items\":[{\"text\":\"Chrome\",\"link\":\"/frontend/debug-skill/chrome.html\"},{\"text\":\"Vscode\",\"link\":\"/frontend/debug-skill/vscode.html\"},{\"text\":\"Fiddler\",\"link\":\"/frontend/debug-skill/fiddler.html\"},{\"text\":\"Charles\",\"link\":\"/frontend/debug-skill/charles.html\"},{\"text\":\"Wireshark\",\"link\":\"/frontend/debug-skill/wireshark.html\"},{\"text\":\"H5\",\"link\":\"/frontend/debug-skill/h5.html\"}]},{\"text\":\"NodeJS\",\"collapsed\":true,\"items\":[{\"text\":\"基本使用\",\"link\":\"/frontend/node/base.html\"},{\"text\":\"web服务\",\"link\":\"/frontend/node/node-web.html\"},{\"text\":\"多进程与多线程\",\"link\":\"/frontend/node/node-process.html\"},{\"text\":\"常见框架\",\"link\":\"/frontend/node/node-framework.html\"},{\"text\":\"调试技巧\",\"link\":\"/frontend/node/node-debug.html\"},{\"text\":\"性能优化\",\"link\":\"/frontend/node/node-measure.html\"}]},{\"text\":\"Typescript\",\"collapsed\":true,\"items\":[{\"text\":\"1.基本使用\",\"link\":\"/frontend/ts/base.html\"},{\"text\":\"2.配置文件\",\"link\":\"/frontend/ts/ts-configure.html\"}]},{\"text\":\"NestJS\",\"collapsed\":true,\"items\":[{\"text\":\"1.基本使用\",\"link\":\"/frontend/nestjs/base.html\"},{\"text\":\"2.搭建web服务\",\"link\":\"/frontend/nestjs/mvc.html\"},{\"text\":\"3.swagger文档\",\"link\":\"/frontend/nestjs/swagger.html\"},{\"text\":\"4.实用手册\",\"link\":\"/frontend/nestjs/useful.html\"}]},{\"text\":\"Render Mode\",\"link\":\"/frontend/render-mode/base.html\"},{\"text\":\"Canvas\",\"collapsed\":true,\"items\":[{\"text\":\"1.基本使用\",\"link\":\"/frontend/canvas/base.html\"},{\"text\":\"2.炫酷特效\",\"link\":\"/frontend/canvas/magic-effects.html\"}]},{\"text\":\"Project Integration\",\"collapsed\":true,\"items\":[{\"text\":\"1.项目集成\",\"link\":\"/frontend/project-integration/base.html\"},{\"text\":\"2.编辑器之争\",\"link\":\"/frontend/project-integration/choose-editor.html\"},{\"text\":\"3.框架选型\",\"link\":\"/frontend/project-integration/framework.html\"},{\"text\":\"4.打包工具\",\"link\":\"/frontend/project-integration/build-tool.html\"},{\"text\":\"5.语法规范\",\"link\":\"/frontend/project-integration/specification.html\"},{\"text\":\"6.风格指南\",\"link\":\"/frontend/project-integration/style.html\"},{\"text\":\"7.提交规范\",\"link\":\"/frontend/project-integration/git-commit.html\"},{\"text\":\"8.monorepo\",\"link\":\"/frontend/project-integration/monorepo.html\"},{\"text\":\"9.自动化测试\",\"link\":\"/frontend/project-integration/test-framework.html\"},{\"text\":\"10.发布规范\",\"link\":\"/frontend/project-integration/deploy-specification.html\"},{\"text\":\"11.调试技巧\",\"link\":\"/frontend/project-integration/debugger-skill.html\"},{\"text\":\"12.自动化\",\"link\":\"/frontend/project-integration/ci-pipeline.html\"}]},{\"text\":\"Computer Network\",\"collapsed\":true,\"link\":\"/frontend/computer-network/base.html\",\"items\":[{\"text\":\"TCP协议\",\"link\":\"/frontend/computer-network/tcp-protocol.html\"},{\"text\":\"HTTP协议\",\"link\":\"/frontend/computer-network/http-protocol.html\"},{\"text\":\"IP协议\",\"link\":\"/frontend/computer-network/ip-protocol.html\"},{\"text\":\"ARP协议\",\"link\":\"/frontend/computer-network/arp-protocol.html\"}]},{\"text\":\"Performance\",\"collapsed\":true,\"items\":[{\"text\":\"前言\",\"link\":\"/frontend/performance/base.html\"},{\"text\":\"大文件上传\",\"link\":\"/frontend/performance/chunk-upload.html\"},{\"text\":\"大文件下载\",\"link\":\"/frontend/performance/range-download.html\"},{\"text\":\"虚拟滚动一\",\"link\":\"/frontend/performance/virtual-scroll-1.html\"},{\"text\":\"虚拟滚动二\",\"link\":\"/frontend/performance/virtual-scroll-2.html\"},{\"text\":\"网络优化\",\"link\":\"/frontend/performance/network-perf.html\"},{\"text\":\"加载优化\",\"link\":\"/frontend/performance/load-perf.html\"},{\"text\":\"缓存优化\",\"link\":\"/frontend/performance/cache-perf.html\"},{\"text\":\"安全优化\",\"link\":\"/frontend/performance/secure-perf.html\"},{\"text\":\"SEO优化\",\"link\":\"/frontend/performance/seo.html\"},{\"text\":\"Performance工具\",\"link\":\"/frontend/performance/performance.html\"},{\"text\":\"web评分指标\",\"link\":\"/frontend/performance/web-score.html\"},{\"text\":\"node评分指标\",\"link\":\"/frontend/performance/node-score.html\"}]},{\"text\":\"Nginx\",\"link\":\"/frontend/nginx/base.html\"},{\"text\":\"Design Pattern\",\"link\":\"/frontend/pattern/base.html\"},{\"text\":\"Monitor\",\"link\":\"/frontend/monitor/base.html\"},{\"text\":\"Micro Frontend\",\"link\":\"/frontend/micro-frontend/base.html\"},{\"text\":\"Webassembly\",\"link\":\"/frontend/wasm/base.html\"},{\"text\":\"Hybrid App\",\"link\":\"/frontend/hybrid-app/base.html\"},{\"text\":\"Flutter\",\"link\":\"/frontend/flutter/base.html\"}]}],\"/fullstack/\":[{\"text\":\"Docker\",\"items\":[{\"items\":[{\"text\":\"Docker安装与配置\",\"link\":\"/fullstack/docker/install-configure.html\"},{\"text\":\"Docker基础教程\",\"link\":\"/fullstack/docker/base-tutorial.html\"},{\"text\":\"Docker数据卷与持久化\",\"link\":\"/fullstack/docker/volume-store.html\"},{\"text\":\"Docker网络原理\",\"link\":\"/fullstack/docker/network.html\"},{\"text\":\"使用Dockerfile构建镜像\",\"link\":\"/fullstack/docker/dockerfile.html\"},{\"text\":\"使用DockerCompose部署服务\",\"link\":\"/fullstack/docker/docker-compose.html\"},{\"text\":\"使用Docker搭建npm仓库\",\"link\":\"/fullstack/docker/npm-repository.html\"},{\"text\":\"搭建docker私有仓库\",\"link\":\"/fullstack/docker/docker-repository.html\"}]}]},{\"text\":\"Gitlab\",\"items\":[{\"items\":[{\"text\":\"安装与配置\",\"link\":\"/fullstack/gitlab/install-configure.html\"},{\"text\":\"Gitlab Runner安装与配置\",\"link\":\"/fullstack/gitlab/gitlab-runner-install-configure.html\"},{\"text\":\"Gitlab流水线配置\",\"link\":\"/fullstack/gitlab/gitlab-pipeline.html\"},{\"text\":\"Gitlab搭建npm仓库\",\"link\":\"/fullstack/gitlab/npm-repository.html\"}]}]},{\"text\":\"Kubernetes\",\"items\":[{\"items\":[{\"text\":\"初识kubernetes\",\"link\":\"/fullstack/k8s/base.html\"},{\"text\":\"搭建k8s集群\",\"link\":\"/fullstack/k8s/install.html\"}]}]}],\"/article/\":[{\"text\":\"2022\",\"items\":[{\"items\":[{\"text\":\"emoji markup\",\"link\":\"/article/2022/emoji-markup.html\"}]}]},{\"text\":\"2021\",\"items\":[{\"items\":[{\"text\":\"PWA渐进式应用\",\"link\":\"/article/2021/pwa-app.html\"},{\"text\":\"前端性能测试工具\",\"link\":\"/article/2021/performance-tools.html\"},{\"text\":\"Typescript装饰器指南\",\"link\":\"/article/2021/ts-decorator.html\"},{\"text\":\"手写vue图片懒加载插件\",\"link\":\"/article/2021/vue-img-lazyload.html\"},{\"text\":\"谈谈vue内部运行机制\",\"link\":\"/article/2021/vue-core-process.html\"},{\"text\":\"JS中的设计模式\",\"link\":\"/article/2021/js-pattern.html\"},{\"text\":\"flex布局\",\"link\":\"/article/2021/flex-layout.html\"}]}]},{\"text\":\"2020\",\"items\":[{\"items\":[{\"text\":\"关于DOMParser、XMLSerializer、createTreeWalker使用\",\"link\":\"/article/2020/domparser-xml.html\"},{\"text\":\"vscode快捷键\",\"link\":\"/article/2020/vscode-shortcut.html\"},{\"text\":\"优化改善网页的加载及性能\",\"link\":\"/article/2020/optimize-web-server.html\"},{\"text\":\"深入浅出RegExp\",\"link\":\"/article/2020/regexp-guide.html\"},{\"text\":\"从零配置webpack工程\",\"link\":\"/article/2020/webpack-guide.html\"},{\"text\":\"web缓存策略\",\"link\":\"/article/2020/web-cache.html\"}]}]},{\"text\":\"2019\",\"items\":[{\"items\":[{\"text\":\"nvm使用技巧\",\"link\":\"/article/2019/nvm-guide.html\"},{\"text\":\"MySQL从入门到放弃\",\"link\":\"/article/2019/mysql-guide.html\"},{\"text\":\"7天撸完ktv点歌系统\",\"link\":\"/article/2019/ktv-system.html\"},{\"text\":\"css的10中居中方式\",\"link\":\"/article/2019/css-center.html\"},{\"text\":\"Promise使用与原理\",\"link\":\"/article/2019/promise.html\"},{\"text\":\"JS隐式转换\",\"link\":\"/article/2019/js-type-transfer.html\"},{\"text\":\"什么是BFC\",\"link\":\"/article/2019/what-bfc.html\"},{\"text\":\"JS深浅拷贝\",\"link\":\"/article/2019/js-copy.html\"},{\"text\":\"bind、call、apply使用技巧\",\"link\":\"/article/2019/bind-call-apply.html\"}]}]}],\"/talk/\":[{\"items\":[{\"items\":[{\"text\":\"我也赶上了裁员\",\"link\":\"/talk/2023/lose-qoo-job.html\"},{\"text\":\"我爸脚受伤了\",\"link\":\"/talk/2023/dad-foot-injured.html\"},{\"text\":\"二🐑了\",\"link\":\"/talk/2023/second-covid.html\"}]}]}]},\"lastUpdated\":{\"text\":\"最近更新\",\"formatOptions\":{\"dateStyle\":\"medium\"}},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2018-2024 HengShuai\"},\"search\":{\"options\":{\"detailedView\":true,\"miniSearch\":{\"searchOptions\":{\"fields\":[\"title\",\"text\"]}}},\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>